<a href="https://github.com/JinJieBeWater/redgent">
  <h1 align="center">âœ¨ Redgent</h1>
</a>

<p align="center">
    Redgent æ˜¯ä¸€æ¬¾åŸºäº Generative UI çš„å®šæ—¶ä»»åŠ¡ç®¡ç†å·¥å…·ï¼Œé€šè¿‡å¯¹è¯ç•Œé¢ç®¡ç†å®šæ—¶ä»»åŠ¡ï¼Œæ”¯æŒ Reddit æ•°æ®æŠ“å–å’Œ AI åˆ†æ
</p>

<p align="center">
  <a href="#-æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§"><strong>æ ¸å¿ƒåŠŸèƒ½</strong></a> Â·
  <a href="#ï¸-æŠ€æœ¯æ ˆ"><strong>æŠ€æœ¯æ ˆ</strong></a> Â·
  <a href="#ï¸-ç³»ç»Ÿæ¶æ„"><strong>ç³»ç»Ÿæ¶æ„</strong></a> Â·
  <a href="#-å¿«é€Ÿå¼€å§‹"><strong>å¿«é€Ÿå¼€å§‹</strong></a> Â·
  <a href="#-docker-éƒ¨ç½²"><strong>Docker éƒ¨ç½²</strong></a>
</p>

<div align="center">

[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=flat-square&logo=typescript&logoColor=white)](https://www.typescriptlang.org/) [![NestJS](https://img.shields.io/badge/NestJS-E0234E?style=flat-square&logo=nestjs&logoColor=white)](https://nestjs.com/) [![AI SDK](https://img.shields.io/badge/AI%20SDK-000000?style=flat-square&logo=vercel&logoColor=white)](https://sdk.vercel.ai/) [![tRPC](https://img.shields.io/badge/tRPC-2596BE?style=flat-square&logo=trpc&logoColor=white)](https://trpc.io/) [![React](https://img.shields.io/badge/React-20232A?style=flat-square&logo=react&logoColor=61DAFB)](https://reactjs.org/) [![shadcn/ui](https://img.shields.io/badge/shadcn%2Fui-000000?style=flat-square&logo=shadcnui&logoColor=white)](https://ui.shadcn.com/) [![PostgreSQL](https://img.shields.io/badge/PostgreSQL-316192?style=flat-square&logo=postgresql&logoColor=white)](https://postgresql.org/) [![Docker](https://img.shields.io/badge/Docker-2496ED?style=flat-square&logo=docker&logoColor=white)](https://docker.com/)

</div>

<br/>

# âœ¨ Redgent

## âœ¨ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### ğŸ¤– Agent äº¤äº’

- **è‡ªç„¶è¯­è¨€äº¤äº’**: é€šè¿‡å¯¹è¯å¼ AI Agent åˆ›å»ºå’Œç®¡ç†ä»»åŠ¡
- **Generative UI**: å……åˆ†ä½¿ç”¨ç”Ÿæˆå¼ç”¨æˆ·ç•Œé¢ï¼ŒåŠ¨æ€ç”Ÿæˆäº¤äº’ç»„ä»¶
- **æ‰€è§å³AIæ‰€è§**: é€šè¿‡æ•°æ®åŒæ­¥æœºåˆ¶ç¡®ä¿ç”¨æˆ·ç•Œé¢ä¸ AI è®¤çŸ¥ä¸€è‡´

### â° çµæ´»çš„è°ƒåº¦ç³»ç»Ÿ

- **å¤šç§è°ƒåº¦æ¨¡å¼**: æ”¯æŒ Cron è¡¨è¾¾å¼å’Œ Interval ä¸¤ç§è°ƒåº¦æ–¹å¼
- **æ ¡å‡†åŠŸèƒ½**: æ™ºèƒ½æ ¡å‡† Interval ä»»åŠ¡æ‰§è¡Œé—´éš”

### ğŸ“Š æ•°æ®æºä¸åˆ†æ

- **æ•°æ®æºæ”¯æŒ**: å½“å‰æ”¯æŒ Reddit æ•°æ®æº
- **Reddit è¶‹åŠ¿è¿½è¸ª**: è‡ªåŠ¨ç›‘æ§çƒ­é—¨å¸–å­å’Œè®¨è®ºå†…å®¹
- **AI ç®€æ´åˆ†æ**: ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹å¯¹æŠ“å–æ•°æ®è¿›è¡Œç®€çŸ­è€Œé«˜æ•ˆçš„åˆ†æ
- **è‡ªåŠ¨åŒ–æŠ¥å‘Š**: å°†åˆ†æç»“æœæ•´ç†æˆæ¸…æ™°çš„æŠ¥å‘Šï¼Œä¾¿äºå¿«é€ŸæŸ¥é˜…

### ğŸ¨ ç°ä»£åŒ– UI/UX

- **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯è‡ªé€‚åº”å¸ƒå±€
- **å®æ—¶çŠ¶æ€æ˜¾ç¤º**: é€šè¿‡ SSE æ¨é€ä»»åŠ¡å®æ—¶æ‰§è¡Œè¿›åº¦

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æ¶æ„

- **[NestJS](https://nestjs.com/)** - ä¼ä¸šçº§ Node.js æ¡†æ¶
- **[tRPC](https://trpc.io/)** - ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨çš„ API
- **[AI SDK](https://sdk.vercel.ai/)** - ç»Ÿä¸€çš„ AI æ¨¡å‹æ¥å£
- **[Prisma](https://prisma.io/)** - ç°ä»£åŒ– ORM å’Œæ•°æ®åº“å·¥å…·
- **[PostgreSQL](https://postgresql.org/)** - å¯é çš„å…³ç³»å‹æ•°æ®åº“
- **[cache-manager](https://github.com/node-cache-manager/node-cache-manager)** - ç»Ÿä¸€ç¼“å­˜ç®¡ç†

### å‰ç«¯æ¶æ„

- **[React 19](https://react.dev/)** - ç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- **[TanStack Router](https://tanstack.com/router)** - ç±»å‹å®‰å…¨çš„è·¯ç”±ç®¡ç†
- **[TanStack Query](https://tanstack.com/query)** - å¼ºå¤§çš„æ•°æ®è·å–å’Œç¼“å­˜
- **[shadcn/ui](https://ui.shadcn.com/)** - é«˜è´¨é‡ React ç»„ä»¶åº“
- **[Tailwind CSS v4](https://tailwindcss.com/)** - åŸå­åŒ– CSS æ¡†æ¶

### å·¥ç¨‹åŒ–å·¥å…·

- **[Turborepo](https://turbo.build/repo)** - é«˜æ€§èƒ½æ„å»ºç³»ç»Ÿ
- **[pnpm](https://pnpm.io/)** - å¿«é€Ÿã€èŠ‚çœç£ç›˜ç©ºé—´çš„åŒ…ç®¡ç†å™¨
- **[Vitest](https://vitest.dev/)** - å¿«é€Ÿçš„å•å…ƒæµ‹è¯•æ¡†æ¶
- **[Docker](https://docker.com/)** - å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ›ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒäº¤äº’æµç¨‹

ä¸‹é¢çš„åºåˆ—å›¾å±•ç¤ºäº†å…¸å‹çš„ç”¨æˆ·å·¥ä½œæµï¼š

```mermaid
%% Redgent æ ¸å¿ƒä»»åŠ¡æµç¨‹
sequenceDiagram
    participant U as ç”¨æˆ·
    participant AI as Agent
    participant DB as æ•°æ®åº“
    participant SCH as å®šæ—¶ä»»åŠ¡
    participant WF as åˆ†æå·¥ä½œæµ

    %% 1. åˆ›å»ºä»»åŠ¡
    U->>AI: ã€Œç”Ÿæˆä¸€ä¸ªæ¯å¤©6ç‚¹è·å–LLMç›¸å…³ä¿¡æ¯çš„å®šæ—¶ä»»åŠ¡ï¼Œæå–å‡ºLLMç›¸å…³çš„å‰æ²¿è¶‹åŠ¿ã€
    AI->>DB: ä¿å­˜ TaskConfig
    AI-->>U: âœ… ä»»åŠ¡å·²åˆ›å»º

    %% 2. å®šæ—¶æ‰§è¡Œ
    loop æ¯å¤©6ç‚¹
        SCH->>DB: è¯»å– TaskConfig
        SCH->>WF: æŠ“å–ä¿¡æ¯+åˆ†æ
        WF->>DB: ä¿å­˜åˆ†æç»“æœ
    end

    %% 3. æŸ¥çœ‹ç»“æœ
    U->>DB: æŸ¥è¯¢ä»»åŠ¡ç»“æœ
    DB-->>U: è¿”å›åˆ†ææŠ¥å‘Š

    %% 4. ä¿®æ”¹ä»»åŠ¡
    U->>AI: ã€ŒæŠŠæ‰§è¡Œé¢‘ç‡æ”¹æˆæ¯å¤©ä¸€æ¬¡ã€
    AI->>DB: æ›´æ–°è°ƒåº¦é…ç½®
    AI-->>U: âœ… ä»»åŠ¡å·²æ›´æ–°
```

### ä»»åŠ¡ç”Ÿæˆé€»è¾‘

å°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„ä»»åŠ¡é…ç½®ï¼š

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant Agent as Agent
    participant DB as æ•°æ®åº“

    U->>Agent: ã€Œå¸®æˆ‘ç›‘æ§å…³äºå‰ç«¯å¼€å‘çš„ Reddit å¸–å­ï¼Œæ¯ä¸‰ä¸ªå°æ—¶ä¸€æ¬¡ã€
    Agent->>Agent: è§£æç”¨æˆ·æŒ‡ä»¤ï¼Œç”Ÿæˆä»»åŠ¡é…ç½® (è®¡åˆ’æ·»åŠ æ•°æ®æºæ¶æ„)
    Agent->>DB: ä¿å­˜ TaskConfig
    Agent-->>U: âœ… ä»»åŠ¡å·²åˆ›å»º
```

### æ•°æ®æŠ“å–ä¸åˆ†ææµç¨‹

```mermaid
sequenceDiagram
    participant SCH as è°ƒåº¦ç³»ç»Ÿ
    participant DB as æ•°æ®åº“
    participant DS as æ•°æ®æºé€‚é…å™¨(è®¡åˆ’ä¸­/æœªå®ç°)
    participant Reddit as Reddit API
    participant AI as AIåˆ†æå¼•æ“

    SCH->>DB: è¯»å– Task é…ç½®
    DB-->>SCH: è¿”å› payload æ•°æ®æºé…ç½®
    SCH->>DS: æ ¹æ® payload.dataSource é€‰æ‹©é€‚é…å™¨
    DS->>Reddit: åŸºäº keywords/subreddits æŠ“å–å†…å®¹
    Reddit-->>DS: è¿”å›åŸå§‹æ•°æ®
    DS->>DS: å†…å®¹è¿‡æ»¤ä¸å»é‡
    DS->>AI: å‘é€å¤„ç†åçš„æ•°æ®
    AI-->>DS: è¿”å›åˆ†æç»“æœ
    DS->>DB: ä¿å­˜ TaskReport
```

### Generative UI æ‰€è§å³AIæ‰€è§

é€šè¿‡æ•°æ®åŒæ­¥æœºåˆ¶ï¼Œç¡®ä¿ç”¨æˆ·ç•Œé¢ä¸ AI çŠ¶æ€ä¸€è‡´ã€‚å½“ AI ç”Ÿæˆ Tool UI ç»„ä»¶æ—¶ï¼Œç”¨æˆ·çœ‹åˆ°çš„æ•°æ®å§‹ç»ˆä¸ AI çš„è®¤çŸ¥ä¿æŒä¸€è‡´

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant ToolUI as Tool UIç»„ä»¶
    participant AI as AI Agent

    %% AI ç”Ÿæˆ Tool UI
    AI->>ToolUI: ç”Ÿæˆå¹¶æ¸²æŸ“ Tool UI ç»„ä»¶
    ToolUI->>ToolUI: è·å–å¹¶æ˜¾ç¤ºæ•°æ®

    %% å…³é”®ï¼šå®æ—¶åŒæ­¥æœºåˆ¶ï¼Œç»´æŠ¤ part çš„ output
    Note over ToolUI,AI: ğŸ”„ æ ¸å¿ƒåŒæ­¥æœºåˆ¶
    ToolUI->>AI: addToolResult åŒæ­¥æœ€æ–°æ•°æ®åˆ° part.output

    %% ç”¨æˆ·äº¤äº’è§¦å‘æ›´æ–°
    User->>ToolUI: ç”¨æˆ·æ“ä½œï¼ˆç‚¹å‡»ã€ç¿»é¡µã€æ›´æ–°ç­‰ï¼‰
    ToolUI->>ToolUI: æ•°æ®çŠ¶æ€æ›´æ–°
    ToolUI->>AI: addToolResult å†æ¬¡åŒæ­¥æ–°æ•°æ®

    Note over User,AI: âœ… æ‰€è§å³ AI æ‰€è§ï¼šç•Œé¢æ•°æ® = AI è®¤çŸ¥æ•°æ®
```

## ğŸ—ï¸ å·¥ç¨‹åŒ–ä¼˜åŠ¿

### ğŸ”— ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨

- **tRPC ç±»å‹å®‰å…¨**: ä»åç«¯ API åˆ°å‰ç«¯è°ƒç”¨çš„ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨
- **AI å·¥å…·ç±»å‹åŒ–**: 16+ AI å·¥å…·å‡½æ•°ï¼ˆCreateTaskã€UpdateTaskã€GetAllTasks ç­‰ï¼‰å…¨éƒ¨ç±»å‹æ£€æŸ¥
- **å…±äº«ç±»å‹ç³»ç»Ÿ**: é€šè¿‡ç‹¬ç«‹åŒ…ç®¡ç†å®ç°è·¨åº”ç”¨çš„ç±»å‹å®šä¹‰å¤ç”¨

### ğŸ“¦ monorepo æ¶æ„

- **æ•°æ®åº“å±‚æŠ½ç¦»**: ç‹¬ç«‹çš„ `@redgent/db` åŒ…ç»Ÿä¸€ç®¡ç† Prisma å®¢æˆ·ç«¯
- **ä¸šåŠ¡é€»è¾‘å…±äº«**: `@redgent/shared` æä¾›è·¨åº”ç”¨çš„å·¥å…·å‡½æ•°å’Œç±»å‹

## ğŸ“‚ é¡¹ç›®ç»“æ„

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº pnpm å·¥ä½œåŒºçš„ Monorepo é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨ [Turborepo](https://turbo.build/repo) è¿›è¡Œä»»åŠ¡ç¼–æ’ã€‚æœ€ç»ˆå°†åŒ…å«ä»¥ä¸‹æ ¸å¿ƒéƒ¨åˆ†ï¼š

```
/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ core/          # NestJS åç«¯æœåŠ¡
â”‚   â””â”€â”€ web/           # React å‰ç«¯åº”ç”¨
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ database/      # Prisma æ•°æ®åº“å®¢æˆ·ç«¯å’Œæ¨¡å‹
â”‚   â””â”€â”€ shared/        # å…±äº«çš„ç±»å‹å®šä¹‰å’Œå·¥å…·å‡½æ•°
â”œâ”€â”€ tooling/           # å·¥ç¨‹åŒ–é…ç½®
â”‚   â”œâ”€â”€ eslint-config/     # ESLint å…±äº«é…ç½®
â”‚   â”œâ”€â”€ prettier-config/   # Prettier å…±äº«é…ç½®
â”‚   â”œâ”€â”€ typescript-config/ # TypeScript å…±äº«é…ç½®
â”‚   â””â”€â”€ tsup-config/       # tsup æ„å»ºé…ç½®
â””â”€â”€ package.json
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

- **Node.js** >= 18
- **pnpm** >= 9.0.0
- **PostgreSQL** æ•°æ®åº“
- **DeepSeek API Key** ï¼ˆç”¨äº AI åŠŸèƒ½ï¼‰
- **Reddit API** å‡­è¯

### ğŸ’» æœ¬åœ°å¼€å‘

1. **æ•°æ®åº“å‡†å¤‡**

   **æ–¹å¼ä¸€ï¼šä½¿ç”¨æœ¬åœ° Docker æ•°æ®åº“**

   ä½¿ç”¨è„šæœ¬å¿«é€Ÿå¯åŠ¨æœ¬åœ° PostgreSQL æ•°æ®åº“ï¼š

   ```bash
   # å¯åŠ¨æœ¬åœ° PostgreSQL å®¹å™¨
   ./start-database.sh
   ```

   è¯¥è„šæœ¬ä¼šï¼š
   - è‡ªåŠ¨ä» `.env` æ–‡ä»¶è¯»å–æ•°æ®åº“é…ç½®
   - æ£€æŸ¥ Docker/Podman æ˜¯å¦å®‰è£…å’Œè¿è¡Œ
   - åˆ›å»ºå¹¶å¯åŠ¨ PostgreSQL å®¹å™¨
   - å¦‚æœä½¿ç”¨é»˜è®¤å¯†ç ï¼Œä¼šæç¤ºç”Ÿæˆéšæœºå¯†ç 

   **Windows ç”¨æˆ·è¯·æ³¨æ„**ï¼š
   1. éœ€è¦å…ˆå®‰è£… WSL (Windows Subsystem for Linux)
   2. å®‰è£… Docker Desktop
   3. åœ¨ WSL ç¯å¢ƒä¸­è¿è¡Œè„šæœ¬

   **æ–¹å¼äºŒï¼šä½¿ç”¨äº‘æ•°æ®åº“æˆ–è‡ªå»ºæ•°æ®åº“**

   ç›´æ¥åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ä½ çš„ PostgreSQL è¿æ¥å­—ç¬¦ä¸²ã€‚

2. **å…‹éš†é¡¹ç›®**

   ```bash
   git clone https://github.com/JinJieBeWater/redgent.git
   cd redgent
   ```

3. **å®‰è£…ä¾èµ–**

   ```bash
   pnpm install
   ```

4. **ç¯å¢ƒé…ç½®**

   ```bash
   # å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
   cp .env.example .env

   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å¿…è¦çš„é…ç½®ï¼š
   # - REDDIT_CLIENT_ID: Reddit API å®¢æˆ·ç«¯ ID
   # - REDDIT_SECRET: Reddit API å¯†é’¥
   # - DEEPSEEK_API_KEY: DeepSeek AI API å¯†é’¥
   # - DATABASE_URL: PostgreSQL è¿æ¥å­—ç¬¦ä¸²
   # - DIRECT_URL: PostgreSQL è¿æ¥å­—ç¬¦ä¸²
   # - PROXY_URL: (å¯é€‰) ä»£ç†é…ç½®
   ```

5. **å®Œæˆæ•°æ®åº“è®¾ç½®**

   ```bash
   # è¿è¡Œæ•°æ®åº“è¿ç§»
   pnpm turbo run db:migrate

   # ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
   pnpm turbo run db:generate
   ```

6. **å¯åŠ¨å¼€å‘æœåŠ¡**

   ```bash
   # åŒæ—¶å¯åŠ¨å‰åç«¯å¼€å‘æœåŠ¡å™¨
   pnpm dev
   ```

   è®¿é—®åœ°å€ï¼š
   - å‰ç«¯ï¼šhttp://localhost:3000
   - åç«¯ APIï¼šhttp://localhost:3001

### ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# è¿è¡Œé›†æˆæµ‹è¯•
pnpm test:integration

# è¿è¡Œ E2E æµ‹è¯•
pnpm test:e2e

# æµ‹è¯•è¦†ç›–ç‡
pnpm test:cov
```

### ğŸ”§ å¼€å‘å·¥å…·å‘½ä»¤

```bash
# ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–
pnpm lint       # ESLint æ£€æŸ¥
pnpm format     # Prettier æ ¼å¼åŒ–
pnpm typecheck  # TypeScript ç±»å‹æ£€æŸ¥

# æ„å»ºé¡¹ç›®
pnpm build      # æ„å»ºæ‰€æœ‰åŒ…
```

## ğŸ³ Docker éƒ¨ç½²

### ğŸš€ å¿«é€Ÿéƒ¨ç½²

1. **å‡†å¤‡ç¯å¢ƒæ–‡ä»¶**

   ```bash
   # å¤åˆ¶å¹¶é…ç½®ç¯å¢ƒå˜é‡
   cp .env.example .env.production.local
   # ç¼–è¾‘ .env.production.local å¡«å…¥ç”Ÿäº§ç¯å¢ƒé…ç½®
   ```

2. **å¯åŠ¨æœåŠ¡**

   ```bash
   # æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
   docker-compose up -d --build
   ```

   æœåŠ¡è®¿é—®åœ°å€ï¼š
   - å‰ç«¯ï¼šhttp://localhost:3000
   - åç«¯ APIï¼šhttp://localhost:3001

3. **æŸ¥çœ‹æœåŠ¡çŠ¶æ€**

   ```bash
   # æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
   docker-compose ps
   ```

## âš ï¸ æ³¨æ„äº‹é¡¹

- **æ•°æ®åº“**: ç¡®ä¿ PostgreSQL æœåŠ¡å¯è®¿é—®ä¸”å·²åˆ›å»ºå¯¹åº”æ•°æ®åº“
- **ä»»åŠ¡é¢‘ç‡é™åˆ¶**: Reddit API æœ‰é¢‘ç‡é™åˆ¶ï¼Œä¸”ä»»åŠ¡ä¼šå¯¹æ•°æ®åšç¼“å­˜é˜²æ­¢é‡å¤åˆ†æï¼Œè¿‡æ»¤é¢‘ç¹çš„ä»»åŠ¡ä¼šå¯¼è‡´æ•°æ®å…¨éƒ¨å‘½ä¸­ç¼“å­˜å–æ¶ˆä»»åŠ¡ï¼Œè¯·åˆç†è®¾ç½®ä»»åŠ¡é—´éš”
- **ä»£ç†é…ç½®**: å¦‚æœåœ¨ç½‘ç»œå—é™ç¯å¢ƒï¼Œéœ€è¦æ­£ç¡®é…ç½® `PROXY_URL`
- **ç«¯å£å†²çª**: ç¡®ä¿ 3000 å’Œ 3001 ç«¯å£æœªè¢«å ç”¨
